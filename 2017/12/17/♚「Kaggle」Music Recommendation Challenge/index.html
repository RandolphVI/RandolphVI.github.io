<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="baidu-site-verification" content="IYvqjZ3csg">
<meta name="google-site-verification" content="o9GDuh4E6CmwFpEqUYW7VMmq_fysc1_3PpSQSNWSD8Y">


  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-mac-osx.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css">


  <meta name="keywords" content="Machine Learning,Kaggle,">





  <link rel="alternate" href="/atom.xml" title="黃某人" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1">






<meta name="description" content="本文主要介绍了一些本人在 Kaggle 上首战的经验，包括数据的 EDA 、FE 特征工程、所选择的模型、模型融合的以及其他。">
<meta name="keywords" content="Machine Learning,Kaggle">
<meta property="og:type" content="article">
<meta property="og:title" content="♚「Kaggle」 Music Recommendation Challenge">
<meta property="og:url" content="http://randolph.pro/2017/12/17/♚「Kaggle」Music Recommendation Challenge/index.html">
<meta property="og:site_name" content="黃某人">
<meta property="og:description" content="本文主要介绍了一些本人在 Kaggle 上首战的经验，包括数据的 EDA 、FE 特征工程、所选择的模型、模型融合的以及其他。">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://farm8.staticflickr.com/7820/46680387594_4f5c2a631f_o.jpg">
<meta property="og:updated_time" content="2019-03-17T15:02:50.751Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="♚「Kaggle」 Music Recommendation Challenge">
<meta name="twitter:description" content="本文主要介绍了一些本人在 Kaggle 上首战的经验，包括数据的 EDA 、FE 特征工程、所选择的模型、模型融合的以及其他。">
<meta name="twitter:image" content="https://farm8.staticflickr.com/7820/46680387594_4f5c2a631f_o.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: 'KGO9YVRPZZ',
      apiKey: 'dcf60767769bda7791ae195caf3dfb10',
      indexName: 'Randolph',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://randolph.pro/2017/12/17/♚「Kaggle」Music Recommendation Challenge/">





  <title>♚「Kaggle」 Music Recommendation Challenge | 黃某人</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?80985281ddae6899cfd57ad9d458b284";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">黃某人</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">痴</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            About
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://randolph.pro/2017/12/17/♚「Kaggle」Music Recommendation Challenge/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Randolph">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="黃某人">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">♚「Kaggle」 Music Recommendation Challenge</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-plus-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-12-17T00:00:00+08:00">
                2017-12-17
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kaggle/" itemprop="url" rel="index">
                    <span itemprop="name">Kaggle</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/12/17/♚「Kaggle」Music Recommendation Challenge/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/12/17/♚「Kaggle」Music Recommendation Challenge/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/2017/12/17/♚「Kaggle」Music Recommendation Challenge/" class="leancloud_visitors" data-flag-title="♚「Kaggle」 Music Recommendation Challenge">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-fire"></i>
               </span>
               <span class="leancloud-visitors-count"></span>
               <span>℃</span>
               <span class="post-meta-divider">|</span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                <span title="Words count in article">
                  4,949
                </span>
                <span> words </span>
                
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                <span title="Reading time">
                  20
                </span>
                <span> mins </span>
              
            </div>
          

          
              <div class="post-description">
                  本文主要介绍了一些本人在 Kaggle 上首战的经验，包括数据的 EDA 、FE 特征工程、所选择的模型、模型融合的以及其他。
              </div>
          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://farm8.staticflickr.com/7820/46680387594_4f5c2a631f_o.jpg" alt></p>
<p>有关「Machine Learning」的其他学习笔记系列：<a href="http://randolph.pro/categories/Machine-Learning/">「Machine Learning」</a><br>有关「Kaggle」的其他论文学习笔记系列：<a href="http://randolph.pro/categories/Machine-Learning/Kaggle/">「Kaggle」</a><br>有关模型代码：<a href="https://github.com/RandolphVI/Music-Recommendation-System" target="_blank" rel="noopener">「Music Recommendation Challenge」</a></p>
<h1 id="「Music-Recommendation-Challenge」"><a href="#「Music-Recommendation-Challenge」" class="headerlink" title="「Music Recommendation Challenge」"></a>「Music Recommendation Challenge」</h1><h2 id="Step-1-Exploratory-Data-Analysis-EDA"><a href="#Step-1-Exploratory-Data-Analysis-EDA" class="headerlink" title="Step 1: Exploratory Data Analysis(EDA)"></a>Step 1: Exploratory Data Analysis(EDA)</h2><h3 id="原始特征"><a href="# 原始特征" class="headerlink" title="原始特征"></a>原始特征</h3><ul>
<li>用户特征<ul>
<li><code>user_id</code></li>
<li><code>city</code></li>
<li><code>gender</code></li>
<li><code>age</code></li>
</ul>
</li>
<li>音乐特征<ul>
<li><code>song_id</code></li>
<li><code>song_length</code></li>
<li><code>genre_ids</code></li>
<li><code>language</code></li>
<li><code>name</code></li>
<li><code>artist_name</code></li>
<li><code>composer</code></li>
<li><code>lyricist</code></li>
<li><code>isrc</code></li>
</ul>
</li>
<li>交互特征</li>
<li>上下文特征<ul>
<li><code>registered_via</code></li>
<li><code>registration_init_time</code></li>
<li><code>exipration_date</code></li>
<li><code>source_system_tab</code></li>
<li><code>source_screen_name</code></li>
<li><code>source_type</code></li>
</ul>
</li>
</ul>
<h2 id="Step-2-Feature-Engineering"><a href="#Step-2-Feature-Engineering" class="headerlink" title="Step 2:  Feature Engineering"></a>Step 2:  Feature Engineering</h2><p>Feature Engineering 是把 raw data 转换成 features 的整个过程的总称。基本上特征工程就是个手艺活，制作的好坏全凭人的功夫，往细了讲，便是创造力与经验。</p>
<p>以该比赛音乐推荐系统为例，数据集中的特征可以分成以下四种：</p>
<ul>
<li>用户特征：用户本身的各种属性，例如 <code>user id</code>、<code>gender</code>（性别）、<code>city</code>（所在的城市）等</li>
<li>音乐特征：音乐本身的各种属性，例如<code>song id</code>、<code>name</code>（歌曲名）、<code>artist</code>（演唱者）、<code>composer</code>（作曲家）、<code>lyricist</code>（作词家）、<code>genre_ids</code>（音乐风格分类）等</li>
<li>交互特征：用户对音乐做出的某项行为，该行为的 aggregation 或交叉特征，例如最近听的歌曲的曲风分布或 <code>most_like_artist_type</code> 喜爱的歌手的类型、<code>listen_count</code>听歌的次数等</li>
<li>上下文特征：用戶对音乐做出的某项行为，该行为的 metadata，例如 <code>registration_init_time</code> 注册的时间、<code>source_type</code> 使用的设备等</li>
</ul>
<p>有些特征是在资料 EDA 阶段就可以拿到，有些特征则需要额外的步骤（例如如透过外部的 API 或者其他模型）才能取得。</p>
<h3 id="联想特征"><a href="# 联想特征" class="headerlink" title="联想特征"></a>联想特征</h3><ul>
<li><p>用户特征</p>
<ul>
<li><code>registration_year</code>: 该用户的注册年份</li>
<li><code>registration_month</code>：该用户的注册月份</li>
<li><code>registration_date</code>：该用户的注册日</li>
<li><code>expiration_year</code>: 该用户的退订年份</li>
<li><code>expiration_month</code>：该用户的退订月份</li>
<li><code>expiration_date</code>：该用户的退订日</li>
<li><code>membership_days</code>：该用户从注册到退订的时间天数</li>
</ul>
</li>
<li><p>音乐特征</p>
<ul>
<li><code>is_featured</code>：判断 <code>artist</code> 中是否存在 <code>feat.</code> 信息（<strong><code>.feat</code></strong> 是 <strong>featuring</strong> 的缩写，如果直译的话，指「以……为特色、亮点」。<strong><code>feat.</code></strong> 在歌曲里面是指专辑表演者与另外（一个或者多个）的艺人 / 组合的合作，也就是请人在歌曲中客串。）</li>
<li><code>smaller_song</code>：判断 <code>song_length</code> 是否小于 <code>avg_song_length</code> （<code>avg_song_length</code> 是 <strong>train &amp; test</strong> 所出现的所有 <code>song_length</code> 的平均长度） </li>
<li><code>artist_composer</code>：判断 <code>artisit</code> 与 <code>composer</code> 中是否出现同样的艺人，如果有则记为 1，否则记为 0（间接反映艺人的有才程度）</li>
<li><code>artist_composer_lyricist</code>：判断 <code>artisit</code> 、 <code>composer</code> 以及 <code>lyricist</code> 中是否出现同样的艺人，如果有则记为 1，否则记为 0（间接反映艺人的有才程度）</li>
<li><code>genre_count</code>： 该歌曲的 <code>genre_ids</code> 的个数</li>
<li><code>artist_count</code>：该歌曲的 <code>artist</code> 的个数</li>
<li><code>composer_count</code>：该歌曲的 <code>composer</code> 的个数</li>
<li><code>lyricist_count</code>：该歌曲的 <code>lyricist</code> 的个数</li>
<li><code>count_song_played</code>：该歌曲 <code>song_id</code> 在 <strong>train &amp; test</strong> 中出现的次数</li>
<li><code>count_artist_played</code>：该艺人 <code>artist</code> 在 <strong>train &amp; test</strong> 中出现的次数</li>
<li><code>count_genre_played</code>：该曲风 <code>genre_ids</code> 在 <strong>train &amp; test</strong> 中出现的次数</li>
<li><code>count_genre_like</code>： 该曲风 <code>genre_ids</code> 在 <strong>train</strong> 中 <strong><code>target=1</code></strong>（即被喜欢）的次数</li>
<li><code>genre_like_ratio</code>：<code>count_genre_like</code> / <code>count_genre_played</code>（反映歌曲被喜爱的程度，或者说流行的程度）</li>
<li><code>song_country</code>：根据 <code>isrc</code> 信息得到的歌曲所属的国家信息</li>
<li><code>song_publisher</code>：根据 <code>isrc</code> 信息得到的歌曲所属的发布商信息</li>
<li><code>song_year</code>：根据 <code>isrc</code> 信息得到的歌曲所属的发布年份信息</li>
</ul>
</li>
<li><p>交互特征</p>
</li>
<li><p>上下文特征</p>
<ul>
<li><p><code>als_model_prediction</code>：来自 ALS 模型的预测值，该用户对某音乐的偏好程度</p>
</li>
<li><p><code>gbdt_model_index</code>: 来自 GBDT 模型的 tree index，某 observation 的自动特征</p>
</li>
</ul>
</li>
</ul>
<h3 id="2-1-Missing-Value-Imputation- 缺失值处理"><a href="#2-1-Missing-Value-Imputation- 缺失值处理" class="headerlink" title="2.1 Missing Value Imputation 缺失值处理"></a>2.1 Missing Value Imputation 缺失值处理 </h3><p> 最简单暴力的做法当然就是直接 drop 掉那些含有缺失值的 rows。</p>
<ul>
<li>针对 numerical 特征的缺失值，可以用以下方式取代：<ul>
<li><code>0</code>，缺点是可能会混淆其他本来就是 0 的数值</li>
<li><code>-999</code>，用某个正常情况下不会出现的数值代替，但是选得不好可能会变成异常值，要特别对待</li>
<li>Mean，平均数（例如用户年龄信息 <code>bd</code> 存在许多异常值（存在负数、零甚至超过一百），对于那些异常值可以用 <code>age</code> 的平均值来代替）</li>
<li>Median，中位数，跟平均数相比，不会被异常值干扰</li>
</ul>
</li>
<li>针对 categorical 特征的缺失值，可以用以下方式取代：<ul>
<li>Mode，众数，最常见的值</li>
<li>改成 <code>Others</code> 之类的值</li>
</ul>
</li>
</ul>
<p>假设你要填补 <code>age</code> 这个特征，然后你有其他例如 <code>gender</code> 这样的特征，你可以分别计算男性和女性的 <code>bd</code> 的平均数、中位数和众数来填补缺失值；更复杂一点的方式是，你可以把没有缺失值的数据挑出来，用它们来训练一个 regression 或 classification 模型，用这个模型来预测缺失值。</p>
<p>不过其实有些算法是可以容许缺失值的，这时候可以新增一个<code>has_missing_value</code> 栏位（称为 NA indicator column）。</p>
<h3 id="2-2-Outliers-Detection- 野点处理"><a href="#2-2-Outliers-Detection- 野点处理" class="headerlink" title="2.2 Outliers Detection 野点处理"></a>2.2 Outliers Detection 野点处理 </h3><p> 发现离群值最直观的方式就是画图表，针对单一特征可以使用 box plot；两两特征则可以使用 scatter plot。</p>
<p>处置离群值的方式通常是直接删除或是做变换（例如 log transformation 或 binning），当然你也可以套用处理缺失值的方式。</p>
<h3 id="2-3-Duplicate-Entries-Removal- 异常值处理"><a href="#2-3-Duplicate-Entries-Removal- 异常值处理" class="headerlink" title="2.3 Duplicate Entries Removal 异常值处理"></a>2.3 Duplicate Entries Removal 异常值处理</h3><p>Duplicate 或 redundant 尤其指的是那些 features 都一样，但是 target variable 却不同的数据。</p>
<h3 id="2-4-Feature-Scaling- 特征缩放"><a href="#2-4-Feature-Scaling- 特征缩放" class="headerlink" title="2.4 Feature Scaling 特征缩放"></a>2.4 Feature Scaling 特征缩放 </h3><h4 id="2-4-1-Standardization- 标准化"><a href="#2-4-1-Standardization- 标准化" class="headerlink" title="2.4.1 Standardization 标准化"></a><strong>2.4.1 Standardization 标准化</strong></h4><p> 原始数据集中，因为各个特征的含义和单位不同，每个特征的取值范围可能会差异很大。例如某个二元特征的范围是 0 或 1，另一个特征的范围可能是 $[0, 1000000]$，由于取值范围相差过大导致了模型可能会更偏向于取值范围较大的那个特征。解决的办法就是把各种不同 scale 的特征转换成同样的 scale，称为标准化或正规化。</p>
<p>狭义来说，标准化专门指的是通过计算 z-score，让数据的 mean 为 0、 variance 为 1。</p>
<h4 id="2-4-2-Normalization- 归一化"><a href="#2-4-2-Normalization- 归一化" class="headerlink" title="2.4.2 Normalization 归一化"></a><strong>2.4.2 Normalization 归一化 </strong></h4><p> 归一化是指把每个样本缩放到单位范数（每个样本的范数为 1），适用于计算 dot product 或者两个样本之间的相似性。除了标准化、归一化之外，其他还有通过最大、最小值，把数据的范围缩放到 $[0, 1]$ 或 $[-1, 1]$ 的区间缩放法，不过这个方法容易受异常值的影响。</p>
<p>标准化是分别对单一特征进行（针对 column）；归一化是对每个 observation 进行（针对 row）。</p>
<ul>
<li><strong>对 SVM、logistic regression 或其他使用 squared loss function 的演算法来说，需要 standardization；</strong></li>
<li><strong>对 Vector Space Model 来说，需要 normalization</strong>；</li>
<li><strong>对 tree-based 的算法，基本上都不需要标准化或归一化，它们对 scale 不敏感。</strong></li>
</ul>
<h3 id="2-5-Feature-Transformation- 特征变换"><a href="#2-5-Feature-Transformation- 特征变换" class="headerlink" title="2.5 Feature Transformation 特征变换"></a>2.5 Feature Transformation 特征变换 </h3><p> 针对 continuous 特征，可以进行 Feature Transformation 特征变换：</p>
<h4 id="2-5-1-Rounding"><a href="#2-5-1-Rounding" class="headerlink" title="2.5.1 Rounding"></a><strong>2.5.1 Rounding</strong></h4><p>某些精度有到小数点后第 n 位的特征，如果你其实不需要那么精确，可以考虑 <code>round(value * m)</code> 或 <code>round(log(value))</code> 这样的做法，甚至可以把 round 之后的数值当成 categorical 特征。</p>
<h4 id="2-5-2-Log-Transformation"><a href="#2-5-2-Log-Transformation" class="headerlink" title="2.5.2 Log Transformation"></a><strong>2.5.2 Log Transformation</strong></h4><p>因为 $x$ 越大，$log(x)$ 增长的速度就越慢，所以 <strong> 取 log 的意义是可以 compress 大数和 expand 小数</strong>，换句话说就是压缩 “long tail” 和展开 “head”。假设 x 原本的范围是 $[100, 1000]$，$log(x, 10)$ 之后的范围就变成 $[2, 3]$ 了。也常常使用 $log(1 + x)$ 或 $log(\frac{x}{1-x})$。</p>
<p>另外一种类似的做法是 square root 平方根或 cube root 立方根（可以用在负数）。</p>
<h4 id="2-5-3-Binarization"><a href="#2-5-3-Binarization" class="headerlink" title="2.5.3 Binarization"></a><strong>2.5.3 Binarization</strong></h4><p>对数值型的数据设定一个 threshold，大于就赋值为 1、小于就赋值为 0。例如 <code>score</code>，如果你只关心「及格」或「不及格」，可以直接把成绩对应到 1（<code>score &gt;= 60</code>）和 0（<code>score &lt; 60</code>）；或是你要做啤酒销量分析，你可以新增一个 <code>age &gt;= 18</code> 的特征来标示出已成年。</p>
<p>你有一个 <code>color</code> 的 categorical 特征，如果你不在乎实际上是什么颜色的话，其实也可以改成 <code>has_color</code>。</p>
<h4 id="2-5-4-Binning"><a href="#2-5-4-Binning" class="headerlink" title="2.5.4 Binning"></a><strong>2.5.4 Binning</strong></h4><p>也称为 <strong>bucketization</strong>。以 <code>age</code> 这样的特征为例，你可以把所有年龄拆分成 $n$ 段，0-20 岁、20-40 岁、40-60 岁等或是 0-18 岁、18-40 岁、40-70 岁等（等距或等量），然后把个别的年龄对应到某一段，假设 26 岁是对应到第二个 bucket，那新特征的值就是 2。这种方式是人为地指定每个 bucket 的边界值，还有另外一种拆分法是根据数据的分布来拆，称为 quantization 或 quantile binning，你只需要指定 bucket 的数量即可。</p>
<p>同样的概念应用到其他地方，可以把 datetime 特征拆分成上午、中午、下午和晚上；如果是 categorical 特征，可以把出现次数小于某个 threshold 的值改成 <code>Other</code> 之类的。或者是你有一个 occupation 特征，如果你其实不需要非常准确的职业资讯的话，可以把 “Web Developer”、”iOS Developer” 或 “DBA” 这些个别的资料都改成 “Software Engineer”。</p>
<p><strong>Binarization 和 Binning 都是对 continuous 特征离散化，增强模型的非线性泛化能力。</strong></p>
<h4 id="2-5-5-Integer-Encoding"><a href="#2-5-5-Integer-Encoding" class="headerlink" title="2.5.5 Integer Encoding"></a><strong>2.5.5 Integer Encoding</strong></h4><p>也称为 <strong>label encoding</strong>。把每个 category 对应到数字，一种做法是随机对应到 0, 1, 2, 3, 4 等数字；另外一种做法是依照该值出现的频率大小的顺序来给值，例如最常出现的值给 0，依序给 1, 2, 3 等等。如果是针对一些在某种程度上有次序的 categorical 特征（称为 ordinal），例如「钻石会员」「白金会员」「黄金会员」「普通会员」，直接 mapping 成数字可能没什么问题，但是如果是类似 <code>color</code> 或 <code>city</code> 这样的没有明显大小的特征的话，还是用 one-hot encoding 比较合适。不过如果用的是 tree-based 的算法就无所谓了。</p>
<p>有些 categorical 特征也可能会用数字表示（例如 id），跟 continuous 特征的差别是，数值的差异或大小对 categorical 特征来说没有太大的意义。</p>
<h4 id="2-5-6-One-hot-Encoding-OHE"><a href="#2-5-6-One-hot-Encoding-OHE" class="headerlink" title="2.5.6 One-hot Encoding(OHE)"></a><strong>2.5.6 One-hot Encoding(OHE)</strong></h4><p>如果某个特征有 $m$ 种值（例如 Taipei, Beijing, Tokyo），那它 one-hot encode 之后就会变成长度为 $m$ 的向量：</p>
<ul>
<li>Taipei: [1, 0 ,0]</li>
<li>Beijing: [0, 1, 0]</li>
<li><p>Tokyo: [0, 0, 1]</p>
<p>你也可以改用 Dummy coding，这样就只需要产生长度为 $m -1$ 的向量：</p>
</li>
<li><p>Taipei: [1, 0]</p>
</li>
<li>Beijing: [0, 1]</li>
<li>Tokyo: [0, 0]</li>
</ul>
<p>One-hot Encoding 的缺点是容易造成特征的维度大幅增加和没办法处理之前没见过的值。</p>
<h4 id="2-5-7-Bin-counting"><a href="#2-5-7-Bin-counting" class="headerlink" title="2.5.7 Bin-counting"></a><strong>2.5.7 Bin-counting</strong></h4><p>例如在 Computational Advertising 中，如果你有针对每个 user 的「广告曝光数（包含点击和未点击）」和「广告点击数」，你就可以算出每个 user 的「点击率」，然后用这个机率来表示每个 user，反之也可以对 ad id 使用类似的做法。</p>
  <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ad_id   ad_views  ad_clicks  ad_ctr</span><br><span class="line"><span class="number">412533</span>  <span class="number">18339</span>     <span class="number">1355</span>       <span class="number">0.074</span></span><br><span class="line"><span class="number">423334</span>  <span class="number">335</span>       <span class="number">12</span>         <span class="number">0.036</span></span><br><span class="line"><span class="number">345664</span>  <span class="number">1244</span>      <span class="number">132</span>        <span class="number">0.106</span></span><br><span class="line"><span class="number">349833</span>  <span class="number">35387</span>     <span class="number">1244</span>       <span class="number">0.035</span></span><br></pre></td></tr></table></figure>
<p>换个思路，如果你有一个 brand 的特征，然后你可以从 user 的购买记录中找出购买 A 品牌的人，有 70% 的人会购买 B 品牌、有 40% 的人会购买 C 品牌；购买 D 品牌的人，有 10% 的人会购买 A 品牌和 E 品牌，你可以每个品牌表示成这样：</p>
  <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">brand</span>  <span class="selector-tag">A</span>    <span class="selector-tag">B</span>    <span class="selector-tag">C</span>    <span class="selector-tag">D</span>    <span class="selector-tag">E</span></span><br><span class="line"><span class="selector-tag">A</span>      1<span class="selector-class">.0</span>  0<span class="selector-class">.7</span>  0<span class="selector-class">.4</span>  0<span class="selector-class">.0</span>  0<span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">B</span>      ...</span><br><span class="line"><span class="selector-tag">C</span>      ...</span><br><span class="line"><span class="selector-tag">D</span>      0<span class="selector-class">.1</span>  0<span class="selector-class">.0</span>  0<span class="selector-class">.0</span>  1<span class="selector-class">.0</span>  0<span class="selector-class">.1</span></span><br><span class="line"><span class="selector-tag">E</span>      ...</span><br></pre></td></tr></table></figure>
<h4 id="2-5-8-LabelCount-Encoding"><a href="#2-5-8-LabelCount-Encoding" class="headerlink" title="2.5.8 LabelCount Encoding"></a><strong>2.5.8 LabelCount Encoding</strong></h4><p>类似 Bin-cunting 的做法，一样是利用现有的 count 或其他统计上的资料，差别在于 LabelCount Encoding 最后用的是次序而不是数值本身。优点是对异常值不敏感。</p>
  <figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ad_id   ad_clicks  ad_rank</span><br><span class="line"><span class="number">412533</span>  <span class="number">1355</span>       <span class="number">1</span></span><br><span class="line"><span class="number">423334</span>  <span class="number">12</span>         <span class="number">4</span></span><br><span class="line"><span class="number">345664</span>  <span class="number">132</span>        <span class="number">3</span></span><br><span class="line"><span class="number">349833</span>  <span class="number">1244</span>       <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h4 id="2-5-9-Count-Vectorization"><a href="#2-5-9-Count-Vectorization" class="headerlink" title="2.5.9 Count Vectorization"></a><strong>2.5.9 Count Vectorization</strong></h4><p>除了可以用在 text 特征之外，如果你有 comma-seperated 的 categorical 特征也可以使用这个方法。例如电影类型 <code>genre</code>，里头的值为 <code>Action, Sci-Fi, Drama</code>，就可以先用 <code>RegexTokenizer</code> 转成 <code>Array(&quot;action&quot;, &quot;sci-fi&quot;, &quot;drama&quot;)</code>，再用 <code>CountVectorizer</code> 转成 vector。</p>
<h4 id="2-5-10-Feature-Hashing"><a href="#2-5-10-Feature-Hashing" class="headerlink" title="2.5.10 Feature Hashing"></a><strong>2.5.10 Feature Hashing</strong></h4><p>以 user id 为例，透过一个 hash function 把每一个 user id 映射到 <code>(hashed_1, hashed_2, ..., hashed_m)</code> 的某个值。指定 m &lt;&lt; user id 的取值范围，所以缺点是会有 collision（如果你的 model 足够 robust，倒也是可以不管），优点是可以良好地处理之前没见过的值和罕见的值。当然不只可以 hash 单一值，也可以 hash 一个 vector。</p>
<p>你可以把 feature hashing 表示为单一栏位的数值（例如 2）或是类似 one-hot encoding 那样的多栏位的 binary 表示法（例如 [0, 0, 1]）。</p>
<h4 id="2-5-11-Category-Embedding"><a href="#2-5-11-Category-Embedding" class="headerlink" title="2.5.11 Category Embedding"></a><strong>2.5.11 Category Embedding</strong></h4><h4 id="2-5-12-User-Profile"><a href="#2-5-12-User-Profile" class="headerlink" title="2.5.12 User Profile"></a><strong>2.5.12 User Profile</strong></h4><p>使用用户画像来表示每个 user id，例如用户的年龄、性别、职业、收入、居住地、偏好的各种 tag 等，把每个 user 表示成一个 feature vector。除了单一维度的特征之外，也可以建立「用户听过的歌都是哪些曲风」、「用户（30 天内）浏览过的文章都是什么分类」，以 TF-IDF 的方式表达。或者是把用户所有喜欢文章对应的向量的平均值作为此用户的 profile。比如某个用户经常关注与推荐系统有关的文章，那么他的 profile 中 “CB”、”CF” 和 “推荐系统” 对应的权重值就会较高。</p>
<h4 id="2-5-13-Rare-Categorical-Varibales"><a href="#2-5-13-Rare-Categorical-Varibales" class="headerlink" title="2.5.13 Rare Categorical Varibales"></a><strong>2.5.13 Rare Categorical Varibales</strong></h4><p>先计算好每一种 category 的数量，然后把小于某个 threshold 的 category 都改成 <code>Others</code> 之类的值。或是使用 clustering 算法来达到同样的目的。你也可以直接建立一个新的 binary feature 叫做 <code>rare</code>，要来标示那些相对少见的类别。</p>
<h4 id="2-5-14-Unseen-Categorical-Variables"><a href="#2-5-14-Unseen-Categorical-Variables" class="headerlink" title="2.5.14 Unseen Categorical Variables"></a><strong>2.5.14 Unseen Categorical Variables</strong></h4><p>当你用 training set 的资料 fit 了一个 <code>StringIndexer</code>（和 <code>OneHotEncoder</code>），把它拿去用在 test set 上时，有一定的机率你会遇到某些 categorical 特征的值只在 test set 出现，所以对只见过 training set 的 transformer 来说，这些就是所谓的 unseen values。</p>
<p>对付 unseen values 通常有几种做法：</p>
<pre><code>1. 用整个 training set + test set 来编码 categorical 特征
2. 直接舍弃含有 unseen values 的那条记录
3. 把 unseen values 改成 `Others` 之类的已知值。
</code></pre><p>如果采用第一种方式，一但你把这个 transformer 拿到 production 去用时，无可避免地还是会遇到 unseen values。不过通常线上的 feature engineering 会有别的做法，例如事先把 user 或 item 的各项特征都算好（定期更新或是 data 产生的时候触发），然后以 id 为 key 存进 Redis 之类的 NoSQL 里，model 要用的时候直接用 user id / item id 拿到处理好的 feature vector。</p>
<h4 id="2-5-15-Large-Categorical-Variables"><a href="#2-5-15-Large-Categorical-Variables" class="headerlink" title="2.5.15 Large Categorical Variables"></a><strong>2.5.15 Large Categorical Variables</strong></h4><p>针对那种非常大的 categorical 特征（例如 id 类的特征），如果你用的是 logistic regression，其实可以硬上 one-hot encoding。不然就是利用上面提到的 feature hashing 或 bin counting 等方式；如果是 GBDT 的话，甚至可以直接用 id 硬上，只要 tree 足够多。</p>
<h3 id="2-6-Feature-Construction- 特征构建"><a href="#2-6-Feature-Construction- 特征构建" class="headerlink" title="2.6 Feature Construction 特征构建"></a>2.6 Feature Construction 特征构建 </h3><p> 特征构建指的是从原有的特征中，人工地创造出新的特征，通常用来解决一般的线性模型没办法学到非线性特征的问题。其中一个重点是能否通过某些办法，在特征中加入某些「额外的资讯」，虽然也得小心数据偏见的问题。</p>
<p>如果你有很多 user 购物的资料，除了可以 aggregate 得到 <code>total spend</code> 这样的 feature 之外，也可以变换一下，变成 <code>spend in last week</code>、<code>spend in last month</code> 和 <code>spend in last year</code> 这种可以表示「趋势」的特征。</p>
<p>例如：</p>
<ol>
<li><p><code>author_avg_page_view</code>: 该文章作者的所有文章的平均浏览数</p>
</li>
<li><p><code>user_visited_days_since_doc_published</code>: 该文章发布到该用户访问经过了多少天</p>
</li>
<li><p><code>user_history_doc_sim_categories</code>: 用户读过的所有文章的分类和该篇文章的分类的 TF-IDF 的相似度</p>
</li>
<li><p><code>user_history_doc_sim_topics</code>: 用户读过的所有文章的内文和该篇文章的内文的 TF-IDF 的相似度</p>
</li>
</ol>
<h4 id="2-6-1-Temporal-Features- 时间特征"><a href="#2-6-1-Temporal-Features- 时间特征" class="headerlink" title="2.6.1 Temporal Features 时间特征"></a><strong>2.6.1 Temporal Features 时间特征 </strong></h4><p> 对于 date / time 类型的资料，除了转换成 timestamp 和取出 <code>day</code>、<code>month</code> 和 <code>year</code> 做成新的栏位之外，也可以对 hour 做 binning（分成上午、中午、晚上之类的）或是对 day 做 binning（分成工作日、周末）；或是想办法查出该日期当天的天气、节日或活动等讯息，例如 <code>is_national_holiday</code> 或 <code>has_sport_events</code>。</p>
<p>更进一步，用 datetime 类的资料通常也可以做成 <code>spend_hours_last_week</code> 或 <code>spend_money_last_week</code> 这种可以用来表示「趋势」的特征。</p>
<h4 id="2-6-2-Text-Features- 文字特征"><a href="#2-6-2-Text-Features- 文字特征" class="headerlink" title="2.6.2 Text Features 文字特征"></a><strong>2.6.2 Text Features 文字特征 </strong></h4><h4 id="2-6-3-Spatial-Features- 地理特征"><a href="#2-6-3-Spatial-Features- 地理特征" class="headerlink" title="2.6.3 Spatial Features 地理特征"></a><strong>2.6.3 Spatial Features 地理特征</strong></h4><h4 id="2-6-4-Cyclical-Features"><a href="#2-6-4-Cyclical-Features" class="headerlink" title="2.6.4 Cyclical Features"></a><strong>2.6.4 Cyclical Features</strong></h4><h3 id="2-7-Feature-Interaction- 特征交互"><a href="#2-7-Feature-Interaction- 特征交互" class="headerlink" title="2.7 Feature Interaction 特征交互"></a>2.7 Feature Interaction 特征交互</h3><p> 假设你有 <code>A</code> 和 <code>B</code> 两个 continuous 特征，你可以用 <code>A + B</code>、<code>A - B</code>、<code>A * B</code> 或 <code>A / B</code> 之类的方式建立新的特征。例如 <code>house_age_at_purchase = house_built_date - house_purchase_date</code> 或是 <code>click_through_rate = n_clicks / n_impressions</code>。</p>
<p>还有一种类似的作法叫 Polynomial Expansion 多项式展开，当 degree 为 2 时，可以把 <code>(x, y)</code> 两个特征变成 <code>(x, x * x, y, x * y, y * y)</code> 五个特征。</p>
<h3 id="2-8-Feature-Combination- 特征组合"><a href="#2-8-Feature-Combination- 特征组合" class="headerlink" title="2.8 Feature Combination 特征组合"></a>2.8 Feature Combination 特征组合 </h3><p><strong> 特征组合主要是针对 categorical 特征，特征交互则是适用于连续值特征</strong>。但是两者的概念是差不多的，就是把两个以上的特征透过某种方式结合在一起，变成新的特征。通常用来解决一般的线性模型没办法学到非线性特征的问题。</p>
<p>假设有 <code>gender</code> 和 <code>wealth</code> 两个特征，分别有 2 和 3 种取值，最简单的方式就是直接 string concatenation 组合出一个新的特征 <code>gender_wealth</code>，共有 2 x 3 = 6 种取值。因为是 categorical 特征，可以直接对 <code>gender_wealth</code>使用 <code>StringIndexer</code> 和 <code>OneHotEncoder</code>。你当然也可以一起组合 continuous 和 categorical 特征，例如 <code>age_wealth</code> 这样的特征，只是 vector 里的值就不是 0 1 而是 <code>age</code> 本身了。</p>
<p>假设 C 是 categorical 特征，N 是 continuous 特征，以下有几种有意义的组合：</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">user_id  age  gender  wealth  gender_wealth  gender_wealth_ohe   age_wealth</span><br><span class="line"><span class="number">1</span>        <span class="number">56</span>   male    rich    male_rich      [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]  [<span class="number">56</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="number">2</span>        <span class="number">30</span>   male    middle  male_middle    [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]  [<span class="number">0</span>, <span class="number">30</span>, <span class="number">0</span>]</span><br><span class="line"><span class="number">3</span>        <span class="number">19</span>   female  rich    female_rich    [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>]  [<span class="number">19</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line"><span class="number">4</span>        <span class="number">62</span>   female  poor    female_poor    [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">62</span>]</span><br><span class="line"><span class="number">5</span>        <span class="number">78</span>   male    poor    male_poor      [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">78</span>]</span><br><span class="line"><span class="number">6</span>        <span class="number">34</span>   female  middle  female_middle  [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]  [<span class="number">0</span>, <span class="number">34</span>, <span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h3 id="2-9-Feature-Extraction- 特征提取"><a href="#2-9-Feature-Extraction- 特征提取" class="headerlink" title="2.9 Feature Extraction 特征提取"></a>2.9 Feature Extraction 特征提取 </h3><p> 通常就是指 dimensionality reduction。</p>
<ul>
<li><strong>Principal Component Analysis (PCA)</strong></li>
<li><strong>Latent Dirichlet Allocation (LDA)</strong></li>
<li><strong>Latent Semantic Analysis (LSA)</strong></li>
</ul>
<h3 id="2-10-Feature-Selection- 特征选择"><a href="#2-10-Feature-Selection- 特征选择" class="headerlink" title="2.10 Feature Selection 特征选择"></a>2.10 Feature Selection 特征选择 </h3><p> 特征选择是指通过某些方法自动地从所有的特征中挑选出有用的特征。</p>
<h4 id="2-10-1-Filter-Method"><a href="#2-10-1-Filter-Method" class="headerlink" title="2.10.1 Filter Method"></a>2.10.1 <strong>Filter Method</strong></h4><p>采用某一种评估指标（发散性、相关性或 Information Gain 等），单独地衡量个别特征跟 target variable 之间的关系，常用的方法有 Chi Square Test（卡方检验）。这种特征选择方式没有任何模型的参与。</p>
<p>以相关性来说，也不见得跟 target variable 的相关性越高就越好。</p>
<h4 id="2-10-2-Wrapper-Method"><a href="#2-10-2-Wrapper-Method" class="headerlink" title="2.10.2 Wrapper Method"></a>2.10.2 <strong>Wrapper Method</strong></h4><p>会采用某个模型来预测你的 target variable，把特征选择想成是一个组合优化的问题，想办法找出一组特征子集能够让模型的评估结果最好。缺点是太耗时间了，实际上不常用。</p>
<h4 id="2-10-3-Embedded-Method"><a href="#2-10-3-Embedded-Method" class="headerlink" title="2.10.3 Embedded Method"></a>2.10.3 <strong>Embedded Method</strong></h4><p>通常会采用一个会为特征赋予 coefficients 或 importances 的演算法，例如 Logistic Regression（特别是使用 L1 penalty）或 GBDT，直接用权重或重要性对所有特征排序，然后取前 n 个作为特征子集。</p>
<h3 id="2-11-Feature-Learning- 特征学习"><a href="#2-11-Feature-Learning- 特征学习" class="headerlink" title="2.11 Feature Learning 特征学习"></a>2.11 Feature Learning 特征学习 </h3><p> 也称为 Representation Learning 或 Automated Feature Engineering。</p>
<ul>
<li><strong>GBDT</strong></li>
<li><strong>Neural Network: Restricted Boltzmann Machines</strong></li>
<li><strong>Deep Learning: Autoencoder</strong></li>
</ul>
<h3 id="Step-3-Choose-the-Model"><a href="#Step-3-Choose-the-Model" class="headerlink" title="Step 3: Choose the Model"></a>Step 3: Choose the Model</h3><h4 id="LIBFFM-GBDT"><a href="#LIBFFM-GBDT" class="headerlink" title="LIBFFM + GBDT"></a>LIBFFM + GBDT</h4><p>This model is called <strong>Field-aware Factorization Machines</strong>. If you want to use this model, please download <a href="http://www.csie.ntu.edu.tw/~r01922136/libffm" target="_blank" rel="noopener">LIBFFM</a> first.</p>
<h4 id="CatBoost"><a href="#CatBoost" class="headerlink" title="CatBoost"></a>CatBoost</h4><h4 id="XGBoost"><a href="#XGBoost" class="headerlink" title="XGBoost"></a>XGBoost</h4><h4 id="LightBGM"><a href="#LightBGM" class="headerlink" title="LightBGM"></a>LightBGM</h4>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Machine-Learning/" rel="tag"># Machine Learning</a>
          
            <a href="/tags/Kaggle/" rel="tag"># Kaggle</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/11/♛「Machine Learning」About Field-aware Factorization Machines/" rel="next" title="♜「Machine Learning」 About Field-aware Factorization Machines">
                <i class="fa fa-chevron-left"></i> ♜「Machine Learning」 About Field-aware Factorization Machines
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/19/♜ 「Datasets」About Khan Academy Data/" rel="prev" title="♜「Datasets」About Khan Academy Data">
                ♜「Datasets」About Khan Academy Data <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Randolph">
          <p class="site-author-name" itemprop="name">Randolph</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">32</span>
                <span class="site-state-item-name">Posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">Categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">Tags</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/RandolphVI" target="_blank" title="Github">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  Github
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.linkedin.com/in/威-黄-88060b74/" target="_blank" title="LinkedIn">
                  
                    <i class="fa fa-fw fa-linkedin"></i>
                  
                  LinkedIn
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://music.163.com/#/user/home?id=57901575" target="_blank" title="Music">
                  
                    <i class="fa fa-fw fa-music"></i>
                  
                  Music
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://steamcommunity.com/id/Chinawolfman/" target="_blank" title="Steam">
                  
                    <i class="fa fa-fw fa-steam"></i>
                  
                  Steam
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.tensorflow.org" title="TensorFlow" target="_blank">TensorFlow</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.kaggle.com" title="Kaggle" target="_blank">Kaggle</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="https://leetcode.com" title="LeetCode" target="_blank">LeetCode</a>
                </li>
              
                <li class="links-of-blogroll-item">
                  <a href="http://weekly.codetengu.com" title="CodeTengu" target="_blank">CodeTengu</a>
                </li>
              
            </ul>
          </div>
        
        
        <div>
          <iframe id="iframer" frameborder="no" border="0" marginwidth="0" marginheight="0" width="320" height="150" src></iframe>
        </div>

        <script language="javascript" type="text/javascript">
          window.onload = function(){
            setTimeout(function () {
              var iframer = document.getElementById("iframer");
              iframer.setAttribute("src","//music.163.com/outchain/player?type=0&id=880407510&auto=0&height=90");
            }, 1000);
          }
        </script>
  
        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#「Music-Recommendation-Challenge」"><span class="nav-number">1.</span> <span class="nav-text">「Music Recommendation Challenge」</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-1-Exploratory-Data-Analysis-EDA"><span class="nav-number">1.1.</span> <span class="nav-text">Step 1: Exploratory Data Analysis(EDA)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原始特征"><span class="nav-number">1.1.1.</span> <span class="nav-text">原始特征</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Step-2-Feature-Engineering"><span class="nav-number">1.2.</span> <span class="nav-text">Step 2:  Feature Engineering</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#联想特征"><span class="nav-number">1.2.1.</span> <span class="nav-text">联想特征</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Missing-Value-Imputation- 缺失值处理"><span class="nav-number">1.2.2.</span> <span class="nav-text">2.1 Missing Value Imputation 缺失值处理 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Outliers-Detection- 野点处理"><span class="nav-number">1.2.3.</span> <span class="nav-text">2.2 Outliers Detection 野点处理 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-Duplicate-Entries-Removal- 异常值处理"><span class="nav-number">1.2.4.</span> <span class="nav-text">2.3 Duplicate Entries Removal 异常值处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-Feature-Scaling- 特征缩放"><span class="nav-number">1.2.5.</span> <span class="nav-text">2.4 Feature Scaling 特征缩放 </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-1-Standardization- 标准化"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">2.4.1 Standardization 标准化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-4-2-Normalization- 归一化"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">2.4.2 Normalization 归一化 </span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-Feature-Transformation- 特征变换"><span class="nav-number">1.2.6.</span> <span class="nav-text">2.5 Feature Transformation 特征变换 </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-1-Rounding"><span class="nav-number">1.2.6.1.</span> <span class="nav-text">2.5.1 Rounding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-2-Log-Transformation"><span class="nav-number">1.2.6.2.</span> <span class="nav-text">2.5.2 Log Transformation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-3-Binarization"><span class="nav-number">1.2.6.3.</span> <span class="nav-text">2.5.3 Binarization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-4-Binning"><span class="nav-number">1.2.6.4.</span> <span class="nav-text">2.5.4 Binning</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-5-Integer-Encoding"><span class="nav-number">1.2.6.5.</span> <span class="nav-text">2.5.5 Integer Encoding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-6-One-hot-Encoding-OHE"><span class="nav-number">1.2.6.6.</span> <span class="nav-text">2.5.6 One-hot Encoding(OHE)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-7-Bin-counting"><span class="nav-number">1.2.6.7.</span> <span class="nav-text">2.5.7 Bin-counting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-8-LabelCount-Encoding"><span class="nav-number">1.2.6.8.</span> <span class="nav-text">2.5.8 LabelCount Encoding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-9-Count-Vectorization"><span class="nav-number">1.2.6.9.</span> <span class="nav-text">2.5.9 Count Vectorization</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-10-Feature-Hashing"><span class="nav-number">1.2.6.10.</span> <span class="nav-text">2.5.10 Feature Hashing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-11-Category-Embedding"><span class="nav-number">1.2.6.11.</span> <span class="nav-text">2.5.11 Category Embedding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-12-User-Profile"><span class="nav-number">1.2.6.12.</span> <span class="nav-text">2.5.12 User Profile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-13-Rare-Categorical-Varibales"><span class="nav-number">1.2.6.13.</span> <span class="nav-text">2.5.13 Rare Categorical Varibales</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-14-Unseen-Categorical-Variables"><span class="nav-number">1.2.6.14.</span> <span class="nav-text">2.5.14 Unseen Categorical Variables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-5-15-Large-Categorical-Variables"><span class="nav-number">1.2.6.15.</span> <span class="nav-text">2.5.15 Large Categorical Variables</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-Feature-Construction- 特征构建"><span class="nav-number">1.2.7.</span> <span class="nav-text">2.6 Feature Construction 特征构建 </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-1-Temporal-Features- 时间特征"><span class="nav-number">1.2.7.1.</span> <span class="nav-text">2.6.1 Temporal Features 时间特征 </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-2-Text-Features- 文字特征"><span class="nav-number">1.2.7.2.</span> <span class="nav-text">2.6.2 Text Features 文字特征 </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-3-Spatial-Features- 地理特征"><span class="nav-number">1.2.7.3.</span> <span class="nav-text">2.6.3 Spatial Features 地理特征</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-6-4-Cyclical-Features"><span class="nav-number">1.2.7.4.</span> <span class="nav-text">2.6.4 Cyclical Features</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-Feature-Interaction- 特征交互"><span class="nav-number">1.2.8.</span> <span class="nav-text">2.7 Feature Interaction 特征交互</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-Feature-Combination- 特征组合"><span class="nav-number">1.2.9.</span> <span class="nav-text">2.8 Feature Combination 特征组合 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-Feature-Extraction- 特征提取"><span class="nav-number">1.2.10.</span> <span class="nav-text">2.9 Feature Extraction 特征提取 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-10-Feature-Selection- 特征选择"><span class="nav-number">1.2.11.</span> <span class="nav-text">2.10 Feature Selection 特征选择 </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-1-Filter-Method"><span class="nav-number">1.2.11.1.</span> <span class="nav-text">2.10.1 Filter Method</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-2-Wrapper-Method"><span class="nav-number">1.2.11.2.</span> <span class="nav-text">2.10.2 Wrapper Method</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-10-3-Embedded-Method"><span class="nav-number">1.2.11.3.</span> <span class="nav-text">2.10.3 Embedded Method</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-11-Feature-Learning- 特征学习"><span class="nav-number">1.2.12.</span> <span class="nav-text">2.11 Feature Learning 特征学习 </span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Step-3-Choose-the-Model"><span class="nav-number">1.2.13.</span> <span class="nav-text">Step 3: Choose the Model</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#LIBFFM-GBDT"><span class="nav-number">1.2.13.1.</span> <span class="nav-text">LIBFFM + GBDT</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CatBoost"><span class="nav-number">1.2.13.2.</span> <span class="nav-text">CatBoost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XGBoost"><span class="nav-number">1.2.13.3.</span> <span class="nav-text">XGBoost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LightBGM"><span class="nav-number">1.2.13.4.</span> <span class="nav-text">LightBGM</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="motto">
  <span class="motto">「莫怕真理无穷 进一寸便有进一寸的欢喜」</span>
</div>

<div class="copyright">
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2019</span>
  
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  
  <span class="author" itemprop="copyrightHolder">Randolph</span>
  
</div>

<!--  -->
<!-- <div class="powered-by"> -->
<!--   Powered by <a class="theme-link" href="https://hexo.io">Hexo</a> -->
<!-- </div> -->
<!--  -->
<!-- <div class="theme-info"> -->
<!--   Theme - -->
<!--   <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next"> -->
<!--     NexT.Mist -->
<!--   </a> -->
<!-- </div> -->


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  

    
      <script id="dsq-count-scr" src="https://randolphvi.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://randolph.pro/2017/12/17/♚「Kaggle」Music Recommendation Challenge/';
          this.page.identifier = '2017/12/17/♚「Kaggle」Music Recommendation Challenge/';
          this.page.title = '♚「Kaggle」 Music Recommendation Challenge';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://randolphvi.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  








  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.1"></script>



  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("rlX1ugcCzQRlB8ljks0eiIKp-gzGzoHsz", "kpFrsFctrAimlBvhHvlgWnhV");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->



  

  

  
  


  

  

</body>
</html>
